# üõ°Ô∏è GRUB Sentinel

`GRUB Sentinel` ‚Äî Bash-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ GRUB2. –°–∫—Ä–∏–ø—Ç –ø–æ–º–æ–≥–∞–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑—á–∏–∫–∞, –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É HiDPI –∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ–º—É –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –û–°.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**
	- –°–±—Ä–æ—Å –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ `grub` –∏ `shim-signed`.
	- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ `/etc/grub.d/` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
	- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ `dpkg`/`apt` –∏ –ø—Ä–µ—Ä–≤–∞–Ω–Ω—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫.

- **–ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ)**
	- –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Ç–µ–º—ã (–ø–æ–∏—Å–∫ –≤ `/boot/grub/themes` –∏ `/usr/share/grub/themes`).
	- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HiDPI (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ `gfxterm`).

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–æ–π**
	- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –û–° –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–ø–∞—Ä—Å–∏–Ω–≥ `grub.cfg`, –æ—á–∏—Å—Ç–∫–∞ –Ω–∞–∑–≤–∞–Ω–∏–π –∏ –∑–∞–ø–∏—Å—å –≤ –∫–æ–Ω—Ñ–∏–≥).

- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
	- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π (`/etc/default/grub`, `/etc/grub.d`).
	- –†–µ–∂–∏–º `--dry-run` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –±–µ–∑ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:

```bash
git clone https://github.com/zemcoviv/grub_sentinel.git
cd grub_sentinel
```

2. –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:

```bash
chmod +x grub_sentinel.sh
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ (—Ç—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ root):

```bash
sudo ./grub_sentinel.sh
```

## ‚öôÔ∏è –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

| –ê—Ä–≥—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|
| `--dry-run` | –†–µ–∂–∏–º —Å–∏–º—É–ª—è—Ü–∏–∏: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –Ω–æ –Ω–µ –≤–Ω–æ—Å–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π. |
| `--backup-dir DIR` | –£–∫–∞–∑–∞—Ç—å –ø–∞–ø–∫—É –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `/var/backups/grub_sentinel`). |
| `--help` | –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. |

–ü—Ä–∏–º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:

```bash
sudo ./grub_sentinel.sh --dry-run
```

## üõ† –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–õ–æ–≥–∏–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ —á–µ—Ç—ã—Ä–µ —ç—Ç–∞–ø–∞:

1. **Backup & Fix**
	 - –°–æ–∑–¥–∞–µ—Ç—Å—è —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –∫–æ–Ω—Ñ–∏–≥–æ–≤.
	 - –£–¥–∞–ª—è—é—Ç—Å—è lock-—Ñ–∞–π–ª—ã `apt`/`dpkg` –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

2. **Prepare**
	 - –°–∫–∞—á–∏–≤–∞—é—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã –∏ —Ç–µ–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `grub2-themes-ubuntu-mate`).
	 - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è HiDPI.

3. **Interactive Selection**
	 - –°–∫–∞–Ω–∏—Ä—É—é—Ç—Å—è –ø–∞–ø–∫–∏ —Å —Ç–µ–º–∞–º–∏ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –≤—ã–±–æ—Ä –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è.
	 - –ü–∞—Ä—Å–∏—Ç—Å—è `grub.cfg`, –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è `menuentry` –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –≤—ã–±—Ä–∞—Ç—å –û–° –¥–ª—è –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∏.

4. **Finalize**
	 - –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –º–µ–Ω—é: `update-grub`.
	 - (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ –≤ EFI: `grub-install`.
	 - –í—ã–≤–æ–¥ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞ –û–° –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π.

## ‚ö†Ô∏è –î–∏—Å–∫–ª–µ–π–º–µ—Ä

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤–Ω–æ—Å–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ (`/boot`, `/etc/default/grub`, EFI-—Ä–∞–∑–¥–µ–ª). –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –±—ç–∫–∞–ø–∞, –∞–≤—Ç–æ—Ä –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–±–æ–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å `--dry-run`.

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Äî –≤ —Ñ–∞–π–ª–µ `LICENSE`.
